{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\prcue\\\\OneDrive\\\\Curso 4\\\\TFG GITT\\\\5. Desarrollo\\\\3. Frontend\\\\frontend_v2\\\\src\\\\components\\\\Dashboard.js\",\n  _s2 = $RefreshSig$();\nimport React from \"react\";\nimport axios from \"axios\";\nimport { useAuth } from \"./AuthContext\";\nimport useProtectedRoute from \"./useProtectedRoute\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s2();\n  var _s = $RefreshSig$();\n  const {\n    currentUser\n  } = useAuth(); // Destructure the currentUser and logout object from the context\n\n  const getUserDetailsAndDisplay = () => {\n    _s();\n    const history = useHistory();\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(\"http://localhost:8000/api/v1/hashes/\", {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n          }\n        });\n        console.log(response.data);\n      } catch (error) {\n        if (error.response && error.response.status === 401) {\n          try {\n            const tokenResponse = await axios.post(\"http://localhost:8000/auth/token/refresh/\", {\n              refresh: localStorage.getItem(\"refresh_token\")\n            });\n            localStorage.setItem(\"access_token\", tokenResponse.data.access);\n            // After refreshing the token, we can re-fetch the data.\n            fetchData();\n          } catch (refreshError) {\n            if (refreshError.response && (refreshError.response.status === 401 || refreshError.response.status === 403)) {\n              // Redirect to login if refresh token is expired or not valid.\n              history.push(\"/login\");\n            } else {\n              // For other errors during the refresh process.\n              alert(`Error refreshing token: ${JSON.stringify(refreshError.response.data)}`);\n            }\n          }\n        } else {\n          // For other errors on the initial request.\n          alert(`Error fetching data: ${JSON.stringify(error.response.data)}`);\n        }\n      }\n    };\n\n    // Fetch the data when the component mounts.\n    React.useEffect(() => {\n      fetchData();\n    }, []);\n    return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n  };\n  _s(getUserDetailsAndDisplay, \"bz2N+u0mX89LO9zOCfVCA9Sa20M=\", true);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: currentUser ? getUserDetailsAndDisplay() : notLoggedIn()\n  }, void 0, false);\n};\n_s2(Dashboard, \"byfRDkJ+t3MKhIwXgwbXYFaZtD0=\", false, function () {\n  return [useAuth];\n});\n_c = Dashboard;\nfunction notLoggedIn() {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Not logged in!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center mt-2\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You need to \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/login\",\n          children: \"log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 23\n        }, this), \" to see this page.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","axios","useAuth","useProtectedRoute","Fragment","_Fragment","jsxDEV","_jsxDEV","Dashboard","_s2","_s","$RefreshSig$","currentUser","getUserDetailsAndDisplay","history","useHistory","fetchData","response","get","headers","Authorization","localStorage","getItem","console","log","data","error","status","tokenResponse","post","refresh","setItem","access","refreshError","push","alert","JSON","stringify","useEffect","children","notLoggedIn","_c","className","fileName","_jsxFileName","lineNumber","columnNumber","href","$RefreshReg$"],"sources":["C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v2/src/components/Dashboard.js"],"sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport useProtectedRoute from \"./useProtectedRoute\";\r\n\r\nconst Dashboard = () => {\r\n  const { currentUser } = useAuth(); // Destructure the currentUser and logout object from the context\r\n\r\n  const getUserDetailsAndDisplay = () => {\r\n    const history = useHistory();\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          \"http://localhost:8000/api/v1/hashes/\",\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\r\n            },\r\n          }\r\n        );\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        if (error.response && error.response.status === 401) {\r\n          try {\r\n            const tokenResponse = await axios.post(\r\n              \"http://localhost:8000/auth/token/refresh/\",\r\n              {\r\n                refresh: localStorage.getItem(\"refresh_token\"),\r\n              }\r\n            );\r\n\r\n            localStorage.setItem(\"access_token\", tokenResponse.data.access);\r\n            // After refreshing the token, we can re-fetch the data.\r\n            fetchData();\r\n          } catch (refreshError) {\r\n            if (\r\n              refreshError.response &&\r\n              (refreshError.response.status === 401 ||\r\n                refreshError.response.status === 403)\r\n            ) {\r\n              // Redirect to login if refresh token is expired or not valid.\r\n              history.push(\"/login\");\r\n            } else {\r\n              // For other errors during the refresh process.\r\n              alert(\r\n                `Error refreshing token: ${JSON.stringify(\r\n                  refreshError.response.data\r\n                )}`\r\n              );\r\n            }\r\n          }\r\n        } else {\r\n          // For other errors on the initial request.\r\n          alert(`Error fetching data: ${JSON.stringify(error.response.data)}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // Fetch the data when the component mounts.\r\n    React.useEffect(() => {\r\n      fetchData();\r\n    }, []);\r\n\r\n    return <></>;\r\n  };\r\n\r\n  return <>{currentUser ? getUserDetailsAndDisplay() : notLoggedIn()}</>;\r\n};\r\n\r\nfunction notLoggedIn() {\r\n  return (\r\n    <>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-5\">\r\n        <h1>Not logged in!</h1>\r\n      </div>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-2\">\r\n        <p>\r\n          You need to <a href=\"/login\">log in</a> to see this page.\r\n        </p>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}