{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{MDBInput,MDBBtn}from\"mdb-react-ui-kit\";import{useAuth}from\"./AuthContext\";import{useNavigate}from\"react-router-dom\";import useProtectedRoute from\"./useProtectedRoute\";import{login}from\"./apiServices\";// Import the new login function\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){useProtectedRoute();var navigate=useNavigate();var _useAuth=useAuth(),setAuthDetails=_useAuth.setAuthDetails;var _useState=useState({username:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var handleChange=function handleChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},e.target.name,e.target.value)));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var responseData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return login(formData);case 4:responseData=_context.sent;if(responseData&&responseData.access&&responseData.refresh){setAuthDetails(formData.username,{access:responseData.access,refresh:responseData.refresh});alert(\"Login successful!\");console.log(\"Login successful!\");navigate(\"/dashboard\");}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);if(_context.t0.response&&_context.t0.response.data){alert(\"Error logging in: \\n\\n\"+JSON.stringify(_context.t0.response.data));console.error(\"Error logging in:\",_context.t0.response.data);}else{alert(\"There was an error: \\n\\n\"+_context.t0);console.error(\"There was an error:\",_context.t0);}case 11:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center mt-5\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"col-lg-3 col-md-5 col-sm-7 col-8\",children:[/*#__PURE__*/_jsx(MDBInput,{className:\"mb-4\",id:\"loginUser\",label:\"User\",name:\"username\",required:true,onChange:handleChange}),/*#__PURE__*/_jsx(MDBInput,{className:\"mb-4\",type:\"password\",id:\"loginPassword\",label:\"Password\",name:\"password\",onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBBtn,{type:\"submit\",className:\"mb-4\",block:true,children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[\"Not a member? \",/*#__PURE__*/_jsx(\"a\",{href:\"/register\",children:\"Register\"})]})]})});};export default Login;","map":{"version":3,"names":["React","useState","MDBInput","MDBBtn","useAuth","useNavigate","useProtectedRoute","login","jsx","_jsx","jsxs","_jsxs","Login","navigate","_useAuth","setAuthDetails","_useState","username","password","_useState2","_slicedToArray","formData","setFormData","handleChange","e","_objectSpread","_defineProperty","target","name","value","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","responseData","wrap","_callee$","_context","prev","next","preventDefault","sent","access","refresh","alert","console","log","t0","response","data","JSON","stringify","error","stop","_x","apply","arguments","className","children","onSubmit","id","label","required","onChange","type","block","href"],"sources":["C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/src/components/Login.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { MDBInput, MDBBtn } from \"mdb-react-ui-kit\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport useProtectedRoute from \"./useProtectedRoute\";\r\nimport { login } from \"./apiServices\"; // Import the new login function\r\n\r\nconst Login = () => {\r\n  useProtectedRoute();\r\n  const navigate = useNavigate();\r\n  const { setAuthDetails } = useAuth();\r\n  const [formData, setFormData] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    try {\r\n      const responseData = await login(formData);\r\n\r\n      if (responseData && responseData.access && responseData.refresh) {\r\n        setAuthDetails(formData.username, {\r\n          access: responseData.access,\r\n          refresh: responseData.refresh,\r\n        });\r\n        alert(\"Login successful!\");\r\n        console.log(\"Login successful!\");\r\n        navigate(\"/dashboard\");\r\n      }\r\n    } catch (error) {\r\n      if (error.response && error.response.data) {\r\n        alert(\"Error logging in: \\n\\n\" + JSON.stringify(error.response.data));\r\n        console.error(\"Error logging in:\", error.response.data);\r\n      } else {\r\n        alert(\"There was an error: \\n\\n\" + error);\r\n        console.error(\"There was an error:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"d-flex align-items-center justify-content-center mt-5\">\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        className=\"col-lg-3 col-md-5 col-sm-7 col-8\"\r\n      >\r\n        <MDBInput\r\n          className=\"mb-4\"\r\n          id=\"loginUser\"\r\n          label=\"User\"\r\n          name=\"username\"\r\n          required\r\n          onChange={handleChange}\r\n        />\r\n        <MDBInput\r\n          className=\"mb-4\"\r\n          type=\"password\"\r\n          id=\"loginPassword\"\r\n          label=\"Password\"\r\n          name=\"password\"\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n\r\n        <MDBBtn type=\"submit\" className=\"mb-4\" block>\r\n          Login\r\n        </MDBBtn>\r\n\r\n        <div className=\"text-center\">\r\n          Not a member? <a href=\"/register\">Register</a>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}