{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\prcue\\\\OneDrive\\\\Curso 4\\\\TFG GITT\\\\5. Desarrollo\\\\3. Frontend\\\\frontend_v2\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useAuth } from \"./AuthContext\";\nimport { useNavigate, Link } from \"react-router-dom\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    currentUser\n  } = useAuth();\n  useEffect(() => {\n    if (!currentUser) return;\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(\"http://localhost:8000/api/v1/hashes/\", {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n          }\n        });\n        console.log(response.data);\n      } catch (error) {\n        if (error.response && error.response.status === 401) {\n          try {\n            const tokenResponse = await axios.post(\"http://localhost:8000/auth/token/refresh/\", {\n              refresh: localStorage.getItem(\"refresh_token\")\n            });\n            localStorage.setItem(\"access_token\", tokenResponse.data.access);\n            fetchData();\n          } catch (refreshError) {\n            if (refreshError.response && (refreshError.response.status === 401 || refreshError.response.status === 403)) {\n              navigate(\"/login\");\n            } else {\n              alert(`Error refreshing token: ${JSON.stringify(refreshError.response.data)}`);\n            }\n          }\n        } else {\n          alert(`Error fetching data: ${JSON.stringify(error.response.data)}`);\n        }\n      }\n    };\n    fetchData();\n  }, [currentUser, navigate]);\n  return currentUser ? /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : notLoggedIn();\n};\n_s(Dashboard, \"kh8E0Q5DygnW3atEwcQ2cwLRb3I=\", false, function () {\n  return [useNavigate, useAuth];\n});\n_c = Dashboard;\nfunction notLoggedIn() {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Not logged in!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center mt-2\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You need to \", /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/login\",\n          children: \"log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 23\n        }, this), \" to see this page.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","axios","useAuth","useNavigate","Link","Fragment","_Fragment","jsxDEV","_jsxDEV","Dashboard","_s","navigate","currentUser","fetchData","response","get","headers","Authorization","localStorage","getItem","console","log","data","error","status","tokenResponse","post","refresh","setItem","access","refreshError","alert","JSON","stringify","notLoggedIn","_c","children","className","fileName","_jsxFileName","lineNumber","columnNumber","to","$RefreshReg$"],"sources":["C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v2/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\n\r\nconst Dashboard = () => {\r\n  const navigate = useNavigate();\r\n  const { currentUser } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (!currentUser) return;\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          \"http://localhost:8000/api/v1/hashes/\",\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\r\n            },\r\n          }\r\n        );\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        if (error.response && error.response.status === 401) {\r\n          try {\r\n            const tokenResponse = await axios.post(\r\n              \"http://localhost:8000/auth/token/refresh/\",\r\n              {\r\n                refresh: localStorage.getItem(\"refresh_token\"),\r\n              }\r\n            );\r\n\r\n            localStorage.setItem(\"access_token\", tokenResponse.data.access);\r\n            fetchData();\r\n          } catch (refreshError) {\r\n            if (\r\n              refreshError.response &&\r\n              (refreshError.response.status === 401 ||\r\n                refreshError.response.status === 403)\r\n            ) {\r\n              navigate(\"/login\");\r\n            } else {\r\n              alert(\r\n                `Error refreshing token: ${JSON.stringify(\r\n                  refreshError.response.data\r\n                )}`\r\n              );\r\n            }\r\n          }\r\n        } else {\r\n          alert(`Error fetching data: ${JSON.stringify(error.response.data)}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [currentUser, navigate]);\r\n\r\n  return currentUser ? <></> : notLoggedIn();\r\n};\r\n\r\nfunction notLoggedIn() {\r\n  return (\r\n    <>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-5\">\r\n        <h1>Not logged in!</h1>\r\n      </div>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-2\">\r\n        <p>\r\n          You need to <Link to=\"/login\">log in</Link> to see this page.\r\n        </p>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}