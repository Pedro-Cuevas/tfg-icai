{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{ethers}from\"ethers\";import{MDBInput,MDBBtn,MDBTextArea,MDBCard,MDBCardBody,MDBCardHeader}from\"mdb-react-ui-kit\";import documentProofABI from\"../assets/documentProofABI.json\";import HashGenerator from\"./HashGenerator\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CONTRACT_ADDRESS=\"0xb9a219631aed55ebc3d998f17c3840b7ec39c0cc\";// HAY QUE MOVERLO A OTRO SITIO\nvar Upload=function Upload(){var _useState=useState({_hash:\"\",_size:0,_ownerName:\"\",_title:\"\",_description:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var setHash=function setHash(hash){setFormData(_objectSpread(_objectSpread({},formData),{},{_hash:hash}));};var handleChange=function handleChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},e.target.name,e.target.value)));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var provider,signer,contract,tx;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();// Prevents default refresh by the browser\nconsole.log(formData);_context.prev=2;provider=new ethers.BrowserProvider(window.ethereum);_context.next=6;return provider.getSigner();case 6:signer=_context.sent;contract=new ethers.Contract(CONTRACT_ADDRESS,documentProofABI,signer);_context.next=10;return contract.newInstance(formData._hash,formData._size,formData._ownerName,formData._title,formData._description);case 10:tx=_context.sent;console.log(\"Transaction hash:\",tx.hash);_context.next=14;return tx.wait();case 14:console.log(\"Transaction confirmed.\");alert(\"Transaction confirmed! Information uploaded to the blockchain\");_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](2);console.error(\"Error uploading information:\",_context.t0);alert(\"Error uploading information: \"+_context.t0.message);case 22:case\"end\":return _context.stop();}},_callee,null,[[2,18]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center mt-5\",children:/*#__PURE__*/_jsxs(MDBCard,{style:{maxWidth:\"45rem\"},children:[/*#__PURE__*/_jsx(MDBCardHeader,{color:\"dark\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Upload a new instance into the blockchain\"})}),/*#__PURE__*/_jsx(MDBCardBody,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Be careful when uploading information to the blockchain. It will be stored forever and it will be public.\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center mt-5 mb-3\",children:/*#__PURE__*/_jsx(HashGenerator,{setHashParent:setHash})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center mt-5\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"col-lg-4 col-md-10 col-sm-10 col-10\",children:[/*#__PURE__*/_jsx(MDBInput,{className:\"mb-4\",type:\"text\",id:\"_hash\",name:\"_hash\",label:\"Hash\",maxLength:66// bytes32 length in hexadecimal\n,pattern:\"^0x[a-fA-F0-9]{64}$\"// Ensure it starts with 0x and followed by 64 hexadecimal characters\n,value:formData._hash,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBInput,{type:\"number\",className:\"mb-4\",id:\"_size\",name:\"_size\",label:\"Size\",value:formData._size,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBInput,{type:\"text\",className:\"mb-4\",id:\"_ownerName\",name:\"_ownerName\",label:\"Owner\",value:formData._ownerName,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBInput,{type:\"text\",className:\"mb-4\",id:\"_title\",name:\"_title\",label:\"Title\",value:formData._title,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBTextArea,{className:\"mb-4\",id:\"_description\",name:\"_description\",rows:4,label:\"Description\",value:formData._description,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(MDBBtn,{type:\"submit\",className:\"mb-4\",block:true,children:\"Upload instance\"})]})})]});};export default Upload;","map":{"version":3,"names":["React","useState","ethers","MDBInput","MDBBtn","MDBTextArea","MDBCard","MDBCardBody","MDBCardHeader","documentProofABI","HashGenerator","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CONTRACT_ADDRESS","Upload","_useState","_hash","_size","_ownerName","_title","_description","_useState2","_slicedToArray","formData","setFormData","setHash","hash","_objectSpread","handleChange","e","_defineProperty","target","name","value","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","provider","signer","contract","tx","wrap","_callee$","_context","prev","next","preventDefault","console","log","BrowserProvider","window","ethereum","getSigner","sent","Contract","newInstance","wait","alert","t0","error","message","stop","_x","apply","arguments","children","className","style","maxWidth","color","setHashParent","onSubmit","type","id","label","maxLength","pattern","onChange","required","rows","block"],"sources":["C:/Users/prcue/OneDrive/Curso 4/TFG GITT/5. Desarrollo/3. Frontend/frontend_v3/src/components/Upload.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport {\r\n  MDBInput,\r\n  MDBBtn,\r\n  MDBTextArea,\r\n  MDBCard,\r\n  MDBCardBody,\r\n  MDBCardHeader,\r\n} from \"mdb-react-ui-kit\";\r\nimport documentProofABI from \"../assets/documentProofABI.json\";\r\nimport HashGenerator from \"./HashGenerator\";\r\n\r\nconst CONTRACT_ADDRESS = \"0xb9a219631aed55ebc3d998f17c3840b7ec39c0cc\"; // HAY QUE MOVERLO A OTRO SITIO\r\n\r\nconst Upload = () => {\r\n  const [formData, setFormData] = useState({\r\n    _hash: \"\",\r\n    _size: 0,\r\n    _ownerName: \"\",\r\n    _title: \"\",\r\n    _description: \"\",\r\n  });\r\n\r\n  const setHash = (hash) => {\r\n    setFormData({ ...formData, _hash: hash });\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault(); // Prevents default refresh by the browser\r\n    console.log(formData);\r\n    try {\r\n      const provider = new ethers.BrowserProvider(window.ethereum);\r\n      const signer = await provider.getSigner();\r\n      const contract = new ethers.Contract(\r\n        CONTRACT_ADDRESS,\r\n        documentProofABI,\r\n        signer\r\n      );\r\n\r\n      const tx = await contract.newInstance(\r\n        formData._hash,\r\n        formData._size,\r\n        formData._ownerName,\r\n        formData._title,\r\n        formData._description\r\n      );\r\n      console.log(\"Transaction hash:\", tx.hash);\r\n\r\n      await tx.wait();\r\n      console.log(\"Transaction confirmed.\");\r\n      alert(\"Transaction confirmed! Information uploaded to the blockchain\");\r\n    } catch (error) {\r\n      console.error(\"Error uploading information:\", error);\r\n      alert(\"Error uploading information: \" + error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-5\">\r\n        <MDBCard style={{ maxWidth: \"45rem\" }}>\r\n          <MDBCardHeader color=\"dark\">\r\n            <h4>Upload a new instance into the blockchain</h4>\r\n          </MDBCardHeader>\r\n          <MDBCardBody>\r\n            <p>\r\n              Be careful when uploading information to the blockchain. It will\r\n              be stored forever and it will be public.\r\n            </p>\r\n          </MDBCardBody>\r\n        </MDBCard>\r\n      </div>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-5 mb-3\">\r\n        <HashGenerator setHashParent={setHash} />\r\n      </div>\r\n      <div className=\"d-flex align-items-center justify-content-center mt-5\">\r\n        <form\r\n          onSubmit={handleSubmit}\r\n          className=\"col-lg-4 col-md-10 col-sm-10 col-10\"\r\n        >\r\n          <MDBInput\r\n            className=\"mb-4\"\r\n            type=\"text\"\r\n            id=\"_hash\"\r\n            name=\"_hash\"\r\n            label=\"Hash\"\r\n            maxLength={66} // bytes32 length in hexadecimal\r\n            pattern=\"^0x[a-fA-F0-9]{64}$\" // Ensure it starts with 0x and followed by 64 hexadecimal characters\r\n            value={formData._hash}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <MDBInput\r\n            type=\"number\"\r\n            className=\"mb-4\"\r\n            id=\"_size\"\r\n            name=\"_size\"\r\n            label=\"Size\"\r\n            value={formData._size}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <MDBInput\r\n            type=\"text\"\r\n            className=\"mb-4\"\r\n            id=\"_ownerName\"\r\n            name=\"_ownerName\"\r\n            label=\"Owner\"\r\n            value={formData._ownerName}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <MDBInput\r\n            type=\"text\"\r\n            className=\"mb-4\"\r\n            id=\"_title\"\r\n            name=\"_title\"\r\n            label=\"Title\"\r\n            value={formData._title}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <MDBTextArea\r\n            className=\"mb-4\"\r\n            id=\"_description\"\r\n            name=\"_description\"\r\n            rows={4}\r\n            label=\"Description\"\r\n            value={formData._description}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n\r\n          <MDBBtn type=\"submit\" className=\"mb-4\" block>\r\n            Upload instance\r\n          </MDBBtn>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Upload;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}